#this file imports data from the UN regarding women in government, percentages of internet use among population, and ratios of boys to girls in primary, secondary, and tertiary education.
#much of the data are missing; however, I opted to create the "master" dataframe with missing data rather than only merging on countries with complete data.
#Other datasets available are GDP, Employment, Expenditure on Education, and Crimes. I hope to complete these later today.

import pandas as pd
#files = ['Women_In_Parliament.csv', 'Ratio_GB_Education.csv', 'Population_Area_Density.csv','GDP.csv','Employment.csv','Expenditure_on_Education.csv','Crimes.csv']
delet = ['Series', 'Region/Country/Area', 'Footnotes', 'Source', 'Year']
master = pd.read_csv('Internet_Usage.csv',encoding='latin1')
master.columns = master.iloc[0]
master = master[139:]
master = master[master['Year'] > '2016']

delet = ['Series', 'Region/Country/Area', 'Footnotes', 'Source', 'Year']
for title in delet:
    del master[title]
master.columns = ['Country', '% Internet Use']


#filename: Women_In_Parliament
data = pd.read_csv('Women_In_Parliament.csv',encoding='latin1')
data.columns = data.iloc[0]
data = data[139:]
data = data[data['Year'] > '2017']

delet = ['Series', 'Last Election Date', 'Last Election Date footnote','Footnotes','Source','Region/Country/Area','Year']
for title in delet:
    del data[title]
data.columns = ['Country', '% Women in Govt']

master = pd.merge(master, data, on = 'Country',how = 'outer')


#filename: Ratio_GB_Education
data = pd.read_csv('Ratio_GB_Education.csv',encoding='latin1')
data.columns = data.iloc[0]
data = data[229:]
data = data[data['Year'] > '2015']
m = list(data.columns.values)
m[1] = 'Country'
m[4] = 'G to B Primary Education'
data.columns = m


delet = ['Region/Country/Area', 'Year','Footnotes','Source']
for title in delet:
    del data[title]
    
grouped = data.groupby(['Series'])
Prim = grouped.get_group('Ratio of girls to boys in primary education')
master = pd.merge(master,Prim, on = 'Country', how = 'outer')

m = list(data.columns.values)
m[2] = 'G to B Secondary Education'
data.columns = m
grouped = data.groupby(['Series'])
Second = grouped.get_group('Ratio of girls to boys in secondary education')
master = pd.merge(master,Second, on = 'Country',how = 'outer')

m = list(data.columns.values)
m[2] = 'G to B Tertiary Education'
data.columns = m
grouped = data.groupby(['Series'])
Prim = grouped.get_group('Ratio of girls to boys in tertiary education')
master = pd.merge(master,Prim, on = 'Country',how = 'outer')

del master['Series_x']
del master['Series_y']
del master['Series']

master = master[1:211]
